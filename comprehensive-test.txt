-- COMPREHENSIVE HASKISH TEST
-- Tests: pattern matching, recursion, guards, higher-order functions,
-- tuples, tuple destructuring, list operations, lambdas, and composition


-- ============ QUICKSORT ============
-- Uses: pattern matching, recursion, filter, lambdas, list concat

sort [] = []
sort (x:xs) = sort (filter (\y -> y <= x) xs) ++ [x] ++ sort (filter (\y -> y > x) xs)


-- ============ STATISTICS ============
-- Uses: recursion, pattern matching, tuples, guards

-- Min using recursion and guards
minimum [x] = x
minimum (x:xs) = minHelper x (minimum xs)

minHelper a b
  | a < b = a
  | otherwise = b

-- Max using recursion and guards
maximum [x] = x
maximum (x:xs) = maxHelper x (maximum xs)

maxHelper a b
  | a > b = a
  | otherwise = b

-- Sum using recursion
total [] = 0
total (x:xs) = x + total xs

-- Average combines multiple functions
average xs = total xs / length xs

-- All stats as tuple - demonstrates tuple construction
allStats xs = (minimum xs, maximum xs, total xs, length xs, average xs)


-- ============ TUPLE DESTRUCTURING ============
-- Uses: tuple pattern matching in function parameters and assignments

-- Function that takes a tuple and destructures it in the parameter
addPair (a, b) = a + b
multiplyPair (x, y) = x * y

-- Function that destructures nested tuples
addNested ((a, b), c) = a + b + c

-- Function using tuple destructuring with list pattern matching
sumPairs [] = 0
sumPairs ((x,y):rest) = (x + y) + sumPairs rest

-- Function that returns and consumes tuples
swap (a, b) = (b, a)
applySwap t = addPair (swap t)

-- Test tuple destructuring in pattern matching
first (x, y) = x
second (x, y) = y
both (x, y) = [x, y]

-- Complex example: process list of tuples
distances [] = []
distances ((x1,y1):rest) = distance (x1,y1) : distances rest

distance (x, y) = x * x + y * y


-- ============ TEST DATA ============
testData = [64, 34, 25, 12, 22, 11, 90, 88, 45, 50, 23, 36, 18]
shortData = [5, 2, 8, 1, 9]
pairData = [(1,2), (3,4), (5,6)]
nestedData = ((10, 20), 30)


-- ============ TESTS TO RUN ============

-- Test sorting:
-- sort testData
-- Expected: [11,12,18,22,23,25,34,36,45,50,64,88,90]

-- Test statistics:
-- allStats testData
-- Expected: (11, 90, 518, 13, 39.846153846...)

-- Test tuple destructuring in assignment (THIS IS THE KEY FEATURE!):
-- (mn, mx, sm, ln, av) = allStats testData
-- Then check: mn, mx, av

-- Test tuple functions:
-- addPair (10, 20)
-- Expected: 30

-- swap (1, 2)
-- Expected: (2, 1)

-- addNested nestedData
-- Expected: 60

-- sumPairs pairData
-- Expected: 21

-- distances [(3,4), (5,12)]
-- Expected: [25, 169]

-- Complete analysis (requires tuple destructuring assignment):
-- sorted = sort testData
-- (mn, mx, sm, ln, av) = allStats testData
-- Then use: sorted, mn, mx, av
